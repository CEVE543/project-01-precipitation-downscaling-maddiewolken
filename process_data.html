<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.395">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>process_data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="process_data_files/libs/clipboard/clipboard.min.js"></script>
<script src="process_data_files/libs/quarto-html/quarto.js"></script>
<script src="process_data_files/libs/quarto-html/popper.min.js"></script>
<script src="process_data_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="process_data_files/libs/quarto-html/anchor.min.js"></script>
<link href="process_data_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="process_data_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="process_data_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="process_data_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="process_data_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="038773b1" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Dates</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MultivariateStats</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">NCDatasets</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsBase</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Unitful</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="32d287a8" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>precip_ds <span class="op">=</span> <span class="fu">NCDataset</span>(<span class="st">"data/precip_tx.nc"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>precip_time <span class="op">=</span> precip_ds[<span class="st">"time"</span>][<span class="op">:</span>]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>precip_lon <span class="op">=</span> precip_ds[<span class="st">"lon"</span>][<span class="op">:</span>]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>precip_lat <span class="op">=</span> precip_ds[<span class="st">"lat"</span>][<span class="op">:</span>]</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>precip <span class="op">=</span> precip_ds[<span class="st">"precip"</span>][<span class="op">:</span>, <span class="op">:</span>, <span class="op">:</span>]</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(precip_ds[<span class="op">:</span>precip]) <span class="co"># learn about it</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">close</span>(precip_ds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>precip (24 × 24 × 16365)
  Datatype:    Union{Missing, Float32} (Float32)
  Dimensions:  lon × lat × time
  Attributes:
   _FillValue           = NaN
   var_desc             = Precipitation
   level_desc           = Surface
   statistic            = Total
   parent_stat          = Other
   long_name            = Daily total of precipitation
   cell_methods         = time: sum
   avg_period           = 0000-00-01 00:00:00
   actual_range         = Float32[0.0, 428.02423]
   units                = mm
   valid_range          = Float32[0.0, 1000.0]
   dataset              = CPC Global Precipitation
   missing_value        = -9.96921e36</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>closed Dataset</code></pre>
</div>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">run_demo</span>()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the path to the raw data folder</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    data_dir <span class="op">=</span> <span class="fu">joinpath</span>(HOMEDIR, <span class="st">"data"</span>, <span class="st">"raw"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    years <span class="op">=</span> <span class="fl">2000</span><span class="op">:</span><span class="fl">2006</span> <span class="co"># example time range- changed to 2000 to 2020 to have more data to work with</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> year <span class="kw">in</span> years</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Download 2m air temperature for the year 2020</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">download_single_level_data</span>.(</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>            year, <span class="fu">joinpath</span>(data_dir, <span class="st">"2m_temperature_</span><span class="sc">$</span>year<span class="st">.nc"</span>), <span class="st">"2m_temperature"</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Download 500 hPa geopotential for the year 2020</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>        level <span class="op">=</span> <span class="fl">500</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">download_pressure_level_data</span>.(</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>            year,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">joinpath</span>(data_dir, <span class="st">"</span><span class="sc">$</span>(level)<span class="st">hPa_geopotential_</span><span class="sc">$</span>year<span class="st">.nc"</span>),</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">"geopotential"</span>,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>            level,</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co"># read in all the 2m temperature data</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    fnames <span class="op">=</span> <span class="fu">shuffle</span>(<span class="fu">glob</span>(<span class="st">"2m_temperature"</span>, data_dir)) <span class="co"># shuffle -- should work even if out of order</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    t2m <span class="op">=</span> <span class="fu">open_mfdataset</span>(fnames, <span class="st">"t2m"</span>) <span class="co"># we sort based on time, so we don't need to sort here</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># read in all the 500 hPa geopotential data</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    fnames <span class="op">=</span> <span class="fu">shuffle</span>(<span class="fu">glob</span>(<span class="st">"500hPa_geopotential"</span>, data_dir))</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    z500 <span class="op">=</span> <span class="fu">open_mfdataset</span>(fnames, <span class="st">"z"</span>)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">display</span>(t2m)</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">display</span>(z500)</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>     <span class="cf">return</span> <span class="cn">nothing</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="fu">run_demo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="113608b2" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Combine 2m_temperature and 500hPa_geopotential datasets from 2000-2006</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">open_mfdataset</span>(files<span class="op">::</span><span class="dt">Vector{String}</span>, variable_name<span class="op">::</span><span class="dt">AbstractString</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Lists to store variable data, time data, and other coordinate data</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    var_data_list <span class="op">=</span> []</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    time_data_list <span class="op">=</span> []</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    coords_data_dict <span class="op">=</span> <span class="fu">Dict</span>()</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Open the first file to get the coordinate names (excluding time and the main variable)</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    ds <span class="op">=</span> <span class="fu">Dataset</span>(files[<span class="fl">1</span>])</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    dimnames <span class="op">=</span> <span class="fu">keys</span>(ds.dim)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    coord_names <span class="op">=</span> <span class="fu">setdiff</span>(<span class="fu">collect</span>(dimnames), [variable_name, <span class="st">"time"</span>])</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">close</span>(ds)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize lists for each coordinate in coords_data_dict</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> coord <span class="kw">in</span> coord_names</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        coords_data_dict[coord] <span class="op">=</span> []</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Open each file, extract data, and store in lists</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> file <span class="kw">in</span> files</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>        ds <span class="op">=</span> <span class="fu">Dataset</span>(file)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Store variable and time data</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">push!</span>(var_data_list, ds[variable_name][<span class="op">:</span>])</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">push!</span>(time_data_list, ds[<span class="st">"time"</span>][<span class="op">:</span>])</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Store other coordinate data</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> coord <span class="kw">in</span> coord_names</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(coords_data_dict[coord], ds[coord][<span class="op">:</span>])</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">close</span>(ds)</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pair variable data with time data and sort by time</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    sorted_pairs <span class="op">=</span> <span class="fu">sort</span>(<span class="fu">collect</span>(<span class="fu">zip</span>(time_data_list, var_data_list)); by<span class="op">=</span>x <span class="op">-&gt;</span> x[<span class="fl">1</span>])</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>    sorted_time_data <span class="op">=</span> [pair[<span class="fl">1</span>] for pair <span class="kw">in</span> sorted_pairs]</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>    sorted_var_data <span class="op">=</span> [pair[<span class="fl">2</span>] for pair <span class="kw">in</span> sorted_pairs]</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Concatenate sorted data</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>    concatenated_data_dict <span class="op">=</span> <span class="fu">Dict</span>(</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>        variable_name <span class="op">=&gt;</span> <span class="fu">vcat</span>(sorted_var_data<span class="op">...</span>), <span class="st">"time"</span> <span class="op">=&gt;</span> <span class="fu">vcat</span>(sorted_time_data<span class="op">...</span>)</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Concatenate coordinate data and add to the dictionary</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> coord <span class="kw">in</span> coord_names</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>        concatenated_data_dict[coord] <span class="op">=</span> <span class="fu">vcat</span>(coords_data_dict[coord]<span class="op">...</span>)</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> concatenated_data_dict</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">glob</span>(pattern<span class="op">::</span><span class="dt">AbstractString</span>, dir<span class="op">::</span><span class="dt">AbstractString</span>=<span class="st">"."</span>)</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert the glob-like pattern to a regex pattern</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>    regex_pattern <span class="op">=</span> <span class="fu">replace</span>(pattern, <span class="st">"*"</span> <span class="op">=&gt;</span> <span class="st">".*"</span>)</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>    regex_pattern <span class="op">=</span> <span class="fu">Regex</span>(regex_pattern)</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># List all files in the directory and filter by the regex pattern</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>    matching_files <span class="op">=</span> <span class="fu">filter</span>(</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>        filename <span class="op">-&gt;</span> <span class="fu">occursin</span>(regex_pattern, filename), <span class="fu">readdir</span>(dir; join<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> matching_files</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>glob (generic function with 2 methods)</code></pre>
</div>
</div>
<div id="c3f9c15e" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>data_dict <span class="op">=</span> <span class="fu">open_mfdataset</span>([<span class="st">"data/raw/2m_temperature_2000.nc"</span>, <span class="st">"data/raw/2m_temperature_2001.nc"</span>, <span class="st">"data/raw/2m_temperature_2002.nc"</span>, <span class="st">"data/raw/2m_temperature_2003.nc"</span>, <span class="st">"data/raw/2m_temperature_2004.nc"</span>, <span class="st">"data/raw/2m_temperature_2005.nc"</span>, <span class="st">"data/raw/2m_temperature_2006.nc"</span>], <span class="st">"t2m"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>Dict{String, Vector} with 4 entries:
  "latitude"  =&gt; Float32[50.0, 49.0, 48.0, 47.0, 46.0, 45.0, 44.0, 43.0, 42.0, …
  "time"      =&gt; [DateTime("2000-01-01T00:00:00"), DateTime("2000-01-01T01:00:0…
  "longitude" =&gt; Float32[-130.0, -129.0, -128.0, -127.0, -126.0, -125.0, -124.0…
  "t2m"       =&gt; Union{Missing, Float64}[280.024, 279.886, 279.823, 277.27, 273…</code></pre>
</div>
</div>
<div id="afb11430" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Display first 5 rows of data_dict to view the new dataframe</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">first</span>(data_dict, <span class="fl">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>4-element Vector{Pair{String, Vector}}:
  "latitude" =&gt; Float32[50.0, 49.0, 48.0, 47.0, 46.0, 45.0, 44.0, 43.0, 42.0, 41.0  …  33.0, 32.0, 31.0, 30.0, 29.0, 28.0, 27.0, 26.0, 25.0, 24.0]
      "time" =&gt; [DateTime("2000-01-01T00:00:00"), DateTime("2000-01-01T01:00:00"), DateTime("2000-01-01T02:00:00"), DateTime("2000-01-01T03:00:00"), DateTime("2000-01-01T04:00:00"), DateTime("2000-01-01T05:00:00"), DateTime("2000-01-01T06:00:00"), DateTime("2000-01-01T07:00:00"), DateTime("2000-01-01T08:00:00"), DateTime("2000-01-01T09:00:00")  …  DateTime("2006-12-31T14:00:00"), DateTime("2006-12-31T15:00:00"), DateTime("2006-12-31T16:00:00"), DateTime("2006-12-31T17:00:00"), DateTime("2006-12-31T18:00:00"), DateTime("2006-12-31T19:00:00"), DateTime("2006-12-31T20:00:00"), DateTime("2006-12-31T21:00:00"), DateTime("2006-12-31T22:00:00"), DateTime("2006-12-31T23:00:00")]
 "longitude" =&gt; Float32[-130.0, -129.0, -128.0, -127.0, -126.0, -125.0, -124.0, -123.0, -122.0, -121.0  …  -74.0, -73.0, -72.0, -71.0, -70.0, -69.0, -68.0, -67.0, -66.0, -65.0]
       "t2m" =&gt; Union{Missing, Float64}[280.02413002591487, 279.88560090312325, 279.82345699757184, 277.2703782111684, 273.20254172694956, 277.26519955237245, 273.38638411420584, 269.11399060754695, 268.4990248755279, 269.0337213962097  …  298.26908908762675, 298.17750789352505, 297.96202273093286, 297.89333683535654, 297.9445145614722, 297.15395337121197, 297.7936749476577, 297.922966045213, 297.78424747179423, 297.58492369639646]</code></pre>
</div>
</div>
<div id="7ec8372e" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Display last 5 rows of time in data_dict to check to make sure all the files were combined</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">last</span>(data_dict[<span class="st">"time"</span>], <span class="fl">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>5-element Vector{DateTime}:
 2006-12-31T19:00:00
 2006-12-31T20:00:00
 2006-12-31T21:00:00
 2006-12-31T22:00:00
 2006-12-31T23:00:00</code></pre>
</div>
</div>
<div id="702f2c68" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Rename data_dict to temp_ds</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>temp_ds <span class="op">=</span> data_dict</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>temp_time <span class="op">=</span> temp_ds[<span class="st">"time"</span>][<span class="op">:</span>]</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>temp_lon <span class="op">=</span> temp_ds[<span class="st">"longitude"</span>][<span class="op">:</span>]</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>temp_lat <span class="op">=</span> temp_ds[<span class="st">"latitude"</span>][<span class="op">:</span>]</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> temp_ds[<span class="op">:</span><span class="st">"t2m"</span>][<span class="op">:</span>, <span class="op">:</span>, <span class="op">:</span>]</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(temp_ds[<span class="op">:</span><span class="st">"t2m"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>109357776-element Vector{Union{Missing, Float64}}:
 280.02413002591487
 279.88560090312325
 279.82345699757184
 277.2703782111684
 273.20254172694956
 277.26519955237245
 273.38638411420584
 269.11399060754695
 268.4990248755279
 269.0337213962097
 269.72377768077007
 267.9462030490602
 266.45215998642857
   ⋮
 298.9680690837853
 298.7108336709408
 298.26908908762675
 298.17750789352505
 297.96202273093286
 297.89333683535654
 297.9445145614722
 297.15395337121197
 297.7936749476577
 297.922966045213
 297.78424747179423
 297.58492369639646</code></pre>
</div>
</div>
<div id="c8ded07f" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check if latitude needs to be reversed</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>temp_lat</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Handle the fact that the latitudes are reversed</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="fu">reverse</span>(temp; dims<span class="op">=</span><span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>109357776×1×1 Array{Union{Missing, Float64}, 3}:
[:, :, 1] =
 280.02413002591487
 279.88560090312325
 279.82345699757184
 277.2703782111684
 273.20254172694956
 277.26519955237245
 273.38638411420584
 269.11399060754695
 268.4990248755279
 269.0337213962097
 269.72377768077007
 267.9462030490602
 266.45215998642857
   ⋮
 298.9680690837853
 298.7108336709408
 298.26908908762675
 298.17750789352505
 297.96202273093286
 297.89333683535654
 297.9445145614722
 297.15395337121197
 297.7936749476577
 297.922966045213
 297.78424747179423
 297.58492369639646</code></pre>
</div>
</div>
<div id="b4b9a1f3" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#I want to subset the temp_ds data to only include Texas-ish region of precip_ds</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Check the range of the latitudes and longitudes for the precip_ds</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>min_precip_lat <span class="op">=</span> <span class="fu">minimum</span>(precip_lat)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>max_precip_lat <span class="op">=</span> <span class="fu">maximum</span>(precip_lat)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>min_precip_lon <span class="op">=</span> <span class="fu">minimum</span>(precip_lon)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>max_precip_lon <span class="op">=</span> <span class="fu">maximum</span>(precip_lon)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Minimum Latitude: </span><span class="sc">$</span>min_precip_lat<span class="st">, Maximum Latitude: </span><span class="sc">$</span>max_precip_lat<span class="st">"</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Minimum Longitude: </span><span class="sc">$</span>min_precip_lon<span class="st">, Maximum Longitude: </span><span class="sc">$</span>max_precip_lon<span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Minimum Latitude: 25.25, Maximum Latitude: 36.75
Minimum Longitude: 258.25, Maximum Longitude: 269.75</code></pre>
</div>
</div>
<div class="sourceCode" id="cb20"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the desired minimum and maximum latitudes and longitudes</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>min_temp_lat <span class="op">=</span> <span class="fl">25.25</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>max_temp_lat <span class="op">=</span> <span class="fl">36.75</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>min_temp_lon <span class="op">=</span> <span class="fl">258.25</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>max_temp_lon <span class="op">=</span> <span class="fl">269.75</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Access latitude and longitude variables</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>lat <span class="op">=</span> temp_ds[<span class="st">"latitude"</span>][<span class="op">:</span>]</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>lon <span class="op">=</span> temp_ds[<span class="st">"longitude"</span>][<span class="op">:</span>]</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create logical indices for latitude and longitude ranges</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>lat_indices <span class="op">=</span> <span class="fu">findall</span>(min_temp_lat <span class="op">.&lt;=</span> lat <span class="op">.&lt;=</span> max_temp_lat)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>lon_indices <span class="op">=</span> <span class="fu">findall</span>(min_temp_lon <span class="op">.&lt;=</span> lon <span class="op">.&lt;=</span> max_temp_lon)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply logical indexing to temperature and time variables</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>subset_temp <span class="op">=</span> temp_ds[<span class="st">"t2m"</span>][<span class="op">:</span>, lat_indices, lon_indices]</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>subset_lat <span class="op">=</span> lat[lat_indices]</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>subset_lon <span class="op">=</span> lon[lon_indices]</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>subset_time <span class="op">=</span> temp_ds[<span class="st">"time"</span>][<span class="op">:</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="eeb61714" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    temp_lon,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    temp_lat,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    temp[<span class="op">:</span>, <span class="op">:</span>, <span class="fl">1</span>]<span class="ch">';</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"Longitude"</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="st">"Latitude"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Temperature on </span><span class="sc">$</span>(temp_time[<span class="fl">1</span>])<span class="st">"</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">

</div>
</div>
<div id="cfb7ae99" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Need to process the precip data further</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Need to handle the fact that the latitudes are reversed</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>precip_lat <span class="op">=</span> <span class="fu">reverse</span>(precip_lat)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>precip <span class="op">=</span> <span class="fu">reverse</span>(precip; dims<span class="op">=</span><span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>24×24×16365 Array{Union{Missing, Float32}, 3}:
[:, :, 1] =
 0.0        0.0202463  0.0        …   1.45262    1.57975    1.37582
 0.114836   0.0602374  0.0308067      2.28766    1.85082    1.20963
 0.237292   0.121709   0.0490085      2.09293    1.45203    1.97182
 0.678864   0.389667   0.0664271      1.65327    1.33469    1.5909
 1.0564     0.24362    0.0964478      2.29071    1.75647    1.43704
 0.594209   0.192309   0.29584    …   1.24682    1.71966    1.23506
 0.153464   0.345075   0.50683        1.14913    2.06668    1.34688
 0.0801041  0.576138   1.06509        0.724487   2.27098    1.45706
 0.133022   0.706655   1.43136        0.181735   3.71962    5.20069
 0.53837    1.4474     2.08092        0.163341   0.759342   2.88819
  missing    missing    missing   …   0.207048   0.461275   1.50673
  missing    missing    missing       0.290842   0.139224   1.43436
  missing    missing    missing       2.59861    2.13086    3.18961
  missing    missing    missing       4.65167    5.16296    5.19326
  missing    missing    missing       6.19447    4.47193    5.3778
  missing    missing    missing   …   5.9169     8.9879     2.81836
  missing    missing    missing       2.24706    8.12168    1.80613
  missing    missing    missing      14.4421    15.1932     6.17247
  missing    missing    missing      20.1535    12.0708    15.3935
  missing    missing    missing      23.8688    16.3307    16.41
  missing    missing    missing   …  18.5016    20.6869    12.77
  missing    missing    missing       7.38247    9.67723   14.9623
  missing    missing    missing       9.88938   10.5213    21.7209
  missing    missing    missing      15.6206    14.5443    20.7196

[:, :, 2] =
 0.0       0.0       0.0        0.0       …  0.0        0.0        0.0
 0.0       0.0       0.0        0.0          0.0        0.0        0.0
 0.0       0.0       0.0        0.0          0.0        0.0        0.0
 0.0       0.0       0.0        0.0          0.0        0.0        0.0
 0.0       0.0       0.0        0.0          0.0        0.0        0.0
 0.0       0.0       0.0        0.0       …  0.0        0.0        0.0
 0.0       0.0       0.0        0.0          0.0        0.0        0.0
 0.0       0.0       0.0507107  0.136311     0.0        0.0        0.0
 0.0       0.0       0.170228   0.353149     0.0        0.0        0.0
 0.0       0.0       0.0242824  0.079515     0.0        0.0828211  0.0344644
  missing   missing   missing    missing  …  0.0        0.232722   0.116297
  missing   missing   missing    missing     0.0        0.120667   0.0780643
  missing   missing   missing    missing     0.0810387  0.209601   0.790819
  missing   missing   missing    missing     0.202908   0.0694368  0.330909
  missing   missing   missing    missing     0.193584   0.366478   0.0834752
  missing   missing   missing    missing  …  0.221516   0.392715   0.334877
  missing   missing   missing    missing     0.0837831  0.847358   0.171142
  missing   missing   missing    missing     0.12625    2.01706    0.660464
  missing   missing   missing    missing     0.0        0.0865614  0.309305
  missing   missing   missing    missing     0.0        0.0        0.206135
  missing   missing   missing    missing  …  0.0        0.355726   0.397575
  missing   missing   missing    missing     0.064151   0.686435   1.2978
  missing   missing   missing    missing     0.373319   0.906296   0.998617
  missing   missing   missing    missing     2.14061    2.16601    0.708568

[:, :, 3] =
 0.0       0.0       0.0       0.0       …  0.0        0.0        0.0
 0.0       0.0       0.0       0.0          0.0        0.0        0.0
 0.0       0.0       0.0       0.0          0.174088   0.0        0.0
 0.0       0.0       0.0       0.0          0.77125    0.0296272  0.16041
 0.0       0.0       0.0       0.0          0.0870539  0.0        0.0822869
 0.0       0.0       0.0       0.0       …  0.0        0.0        0.0
 0.0       0.0       0.0       0.0          0.0        0.0        0.0
 0.0       0.0       0.0       0.0          0.0        0.0        0.0
 0.0       0.0       0.0       0.0          0.0        0.0        0.0
 0.0       0.0       0.0       0.0          0.0        0.0879667  0.391579
  missing   missing   missing   missing  …  0.0        0.052071   0.178373
  missing   missing   missing   missing     0.0        0.0        0.0
  missing   missing   missing   missing     0.0621035  0.0        0.0
  missing   missing   missing   missing     0.509918   0.0        0.0
  missing   missing   missing   missing     0.0975961  0.0        0.0
  missing   missing   missing   missing  …  0.0        0.0        0.0
  missing   missing   missing   missing     0.0        0.0        0.0
  missing   missing   missing   missing     0.0        0.0        0.0
  missing   missing   missing   missing     0.0        0.0        0.0
  missing   missing   missing   missing     0.0        0.0        0.0
  missing   missing   missing   missing  …  0.0        0.0        0.0
  missing   missing   missing   missing     0.0        0.0        0.0707157
  missing   missing   missing   missing     0.0        0.0        0.0
  missing   missing   missing   missing     0.0        0.0        0.0

;;; … 

[:, :, 16363] =
 0.0       0.0       0.0       0.0       …  0.0        0.0        0.0
 0.0       0.0       0.0       0.0          0.0        0.0        0.0
 0.0       0.0       0.0       0.0          0.0        0.0        0.0
 0.0       0.0       0.0       0.0          0.0        0.0        0.0
 0.0       0.0       0.0       0.0          0.0        0.0        0.0
 0.0       0.0       0.0       0.0       …  0.0        0.0        0.0
 0.0       0.0       0.0       0.0          0.0        0.0        0.0
 0.0       0.0       0.0       0.0          0.0        0.0        0.0
 0.0       0.0       0.0       0.0          0.0        0.0        0.0
 0.0       0.0       0.0       0.0          0.0        0.0        0.0
  missing   missing   missing   missing  …  0.0        0.0        0.0
  missing   missing   missing   missing     0.0        0.0        0.0
  missing   missing   missing   missing     0.0        0.0        0.0
  missing   missing   missing   missing     0.0        0.0        0.0
  missing   missing   missing   missing     0.0        0.0259045  0.0
  missing   missing   missing   missing  …  0.207233   0.0        0.0
  missing   missing   missing   missing     0.0300441  0.0        0.0
  missing   missing   missing   missing     0.0296209  0.0        0.0
  missing   missing   missing   missing     0.441014   0.228387   0.0761566
  missing   missing   missing   missing     0.147844   0.189209   0.275329
  missing   missing   missing   missing  …  0.0207723  0.303631   0.72749
  missing   missing   missing   missing     0.0399159  0.220527   1.02891
  missing   missing   missing   missing     0.0        0.127663   0.818845
  missing   missing   missing   missing     0.0        0.0371985  0.641579

[:, :, 16364] =
 0.0       0.0       0.0       0.0       …  0.0  0.0  0.0  0.0  0.0       0.0
 0.0       0.0       0.0       0.0          0.0  0.0  0.0  0.0  0.0       0.0
 0.0       0.0       0.0       0.0          0.0  0.0  0.0  0.0  0.0       0.0
 0.0       0.0       0.0       0.0          0.0  0.0  0.0  0.0  0.0       0.0
 0.0       0.0       0.0       0.0          0.0  0.0  0.0  0.0  0.0       0.0
 0.0       0.0       0.0       0.0       …  0.0  0.0  0.0  0.0  0.0       0.0
 0.0       0.0       0.0       0.0          0.0  0.0  0.0  0.0  0.0       0.0
 0.0       0.0       0.0       0.0          0.0  0.0  0.0  0.0  0.0       0.0
 0.0       0.0       0.0       0.0          0.0  0.0  0.0  0.0  0.0       0.0
 0.0       0.0       0.0       0.0          0.0  0.0  0.0  0.0  0.0       0.0
  missing   missing   missing   missing  …  0.0  0.0  0.0  0.0  0.0       0.0
  missing   missing   missing   missing     0.0  0.0  0.0  0.0  2.37197   0.0
  missing   missing   missing   missing     0.0  0.0  0.0  0.0  0.683025  0.0
  missing   missing   missing   missing     0.0  0.0  0.0  0.0  0.0       0.0
  missing   missing   missing   missing     0.0  0.0  0.0  0.0  0.0       0.0
  missing   missing   missing   missing  …  0.0  0.0  0.0  0.0  0.0       0.0
  missing   missing   missing   missing     0.0  0.0  0.0  0.0  0.0       0.0
  missing   missing   missing   missing     0.0  0.0  0.0  0.0  0.0       0.0
  missing   missing   missing   missing     0.0  0.0  0.0  0.0  0.0       0.0
  missing   missing   missing   missing     0.0  0.0  0.0  0.0  0.0       0.0
  missing   missing   missing   missing  …  0.0  0.0  0.0  0.0  0.0       0.0
  missing   missing   missing   missing     0.0  0.0  0.0  0.0  0.0       0.0
  missing   missing   missing   missing     0.0  0.0  0.0  0.0  0.0       0.0
  missing   missing   missing   missing     0.0  0.0  0.0  0.0  0.0       0.0

[:, :, 16365] =
 0.0       0.0        0.0       …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0        0.0          0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0        0.0          0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0        0.0          0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0        0.0          0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0        0.0       …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0326195  0.0          0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0        0.0          0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0        0.0          0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0        0.0          0.0  0.0  0.0  0.0  0.0  0.0  0.0
  missing   missing    missing  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
  missing   missing    missing     0.0  0.0  0.0  0.0  0.0  0.0  0.0
  missing   missing    missing     0.0  0.0  0.0  0.0  0.0  0.0  0.0
  missing   missing    missing     0.0  0.0  0.0  0.0  0.0  0.0  0.0
  missing   missing    missing     0.0  0.0  0.0  0.0  0.0  0.0  0.0
  missing   missing    missing  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
  missing   missing    missing     0.0  0.0  0.0  0.0  0.0  0.0  0.0
  missing   missing    missing     0.0  0.0  0.0  0.0  0.0  0.0  0.0
  missing   missing    missing     0.0  0.0  0.0  0.0  0.0  0.0  0.0
  missing   missing    missing     0.0  0.0  0.0  0.0  0.0  0.0  0.0
  missing   missing    missing  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
  missing   missing    missing     0.0  0.0  0.0  0.0  0.0  0.0  0.0
  missing   missing    missing     0.0  0.0  0.0  0.0  0.0  0.0  0.0
  missing   missing    missing     0.0  0.0  0.0  0.0  0.0  0.0  0.0</code></pre>
</div>
</div>
<div class="sourceCode" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Run a quick plot to make sure everything is working well</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    precip_lon,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    precip_lat,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    precip[<span class="op">:</span>, <span class="op">:</span>, <span class="fl">1</span>]<span class="ch">';</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"Longitude"</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="st">"Latitude"</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Precipitation on </span><span class="sc">$</span>(precip_time[<span class="fl">1</span>])<span class="st">"</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>